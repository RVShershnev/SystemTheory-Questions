## Классификация оптимальных систем. Задачи оптимизации. Принцип максимума Понтрягина. Динамическое программирование. 
---
В доке
### Классификация оптимальных систем

Системы оптимального управления в зависимости от характера критерия оптимальности можно разделить на три типа:

* равномерно-оптимальные системы;
* статистически-оптимальные системы;
* минимаксно-оптимальные системы.

Равномерно-оптимальная -- это такая система, у которой каждый отдельный процесс является оптимальным. Например, в оптимальных по быстродействию системах при любых начальных условиях и любых возмущениях система приходит наикратчайшим во времени путем к требуемому состоянию.

В статистически-оптимальных системах критерий оптимальности имеет статистический характер. Такие системы должны быть наилучшими в среднем. Здесь не требуется или невозможна оптимизация в каждом отдельном процессе. В качестве статистического критерия чаще всего фигурирует среднее значение какого-либо первичного критерия, например математическое ожидание выхода некоторой величины за определенные пределы.

Минимаксно-оптимальные -- это такие системы, которые в наихудшем случае дают возможно наилучший результат. Они отличаются от равномерно-оптимальных тем, что в ненаихудшем случае могут дать худший результат, чем какая-либо другая система [11].

### Задачи оптимизации

“принцип максимума” Л. С. Понтрягина: для многих управляемых систем может быть построен такой процесс регулирования, при котором само состояние системы в каждый данный момент подсказывает наилучший с точки зрения всего процесса способ действий.
“Принцип максимума” Понтрягина определяет математические условия, необходимые для того, чтобы управление оказалось оптимальным, причем без предварительного определения оптимальной траектории, а путем последовательного регулирования данного процесса. 
принцип Понтрягина: Пусть u(t), 0<=t<=T – такое допустимое управление, т.е. управление, удовлетворяющее ограничению u c- U, что соответствующая ему траектория x(t), выходящая из точки x(t), проходит в момент времени Т через точку х(Т). Для оптимальности управления u(t) траекторией x(t) необходимо существование такой непрерывной ненулевой вектор-функции P0(t), …, Pn(t), которая обладает следующими св-вамии:
а) для лбого t c- [0,T] гамильтониан достигает максимума: max H(p,x,u) = H*(p*,x*,u*);
б) в конечный момент времени t= T Должно выполняться соотношение H*(T) = 0

управляемый динамический объект    Информацию о текущем векторе состояния  x(t )  получаем из наблюдений z =f(x) . Закон управления u(t) определяется с помощью процедуры минимизации функционала вида      Q(x, z, u; t)=min.  Этот функционал и определяет цель управления.
Минимизация функционала – классическая задача вариационного исчисления. В разных прикладных задачах те или иные преимущества имеют:
а) метод динамического программирования Р. Беллмана,
б) метод, основанный на “принципе максимума” Л. Понтрягина.
Запишем систему дифференциальных уравнений – математическую модель управляемого динамического объекта

Принцип максимума Понтрягина. 
Оптимальное управление — это задача проектирования системы, обеспечивающей для заданного объекта управления или процесса закон управления или управляющую последовательность воздействий, обеспечивающих максимум или минимум заданной совокупности критериев качества системы.
“принцип максимума” Л. С. Понтрягина: для многих управляемых систем может быть построен такой процесс регулирования, при котором само состояние системы в каждый данный момент подсказывает наилучший с точки зрения всего процесса способ действий.
“Принцип максимума” Понтрягина определяет математические условия, необходимые для того, чтобы управление оказалось оптимальным, причем без предварительного определения оптимальной траектории, а путем последовательного регулирования данного процесса. 
принцип Понтрягина: Пусть u(t), 0<=t<=T – такое допустимое управление, т.е. управление, удовлетворяющее ограничению u c- U, что соответствующая ему траектория x(t), выходящая из точки x(t), проходит в момент времени Т через точку х(Т). Для оптимальности управления u(t) траекторией x(t) необходимо существование такой непрерывной ненулевой вектор-функции P0(t), …, Pn(t), которая обладает следующими св-вамии:
а) для лбого t c- [0,T] гамильтониан достигает максимума: max H(p,x,u) = H*(p*,x*,u*);
б) в конечный момент времени t= T Должно выполняться соотношение H*(T) = 0

управляемый динамический объект    Информацию о текущем векторе состояния  x(t )  получаем из наблюдений z =f(x) . Закон управления u(t) определяется с помощью процедуры минимизации функционала вида      Q(x, z, u; t)=min.  Этот функционал и определяет цель управления.
Минимизация функционала – классическая задача вариационного исчисления. В разных прикладных задачах те или иные преимущества имеют:
а) метод динамического программирования Р. Беллмана,
б) метод, основанный на “принципе максимума” Л. Понтрягина.
Запишем систему дифференциальных уравнений – математическую модель управляемого динамического объекта
              
Компоненты вектора управления    нужно выбрать так, чтобы минимизировать функционал   , который запишем в виде     
     Введем   -ю компоненту вектора состояния x следующим образом         так что 	 
Очевидно, что начальные условия для компоненты    имеют вид   , а цель управления   . Теперь расширенная система уравнений имеет вид 	 ,    где    	 
Пусть     и    – оптимальное управление и оптимальная траектория. Тогда для любого, мало отличающегося от оптимального процесса можно написать уравнение в вариациях 
и сопряженную систему  	 
Заметим, что    – квадратная матрица.
Определим функцию Понтрягина (расширенную функцию Гамильтона)
	 
Теперь нашу систему можно записать в канонической форме
	        ибо   	     
Л.С. Понтрягиным доказано, что оптимальное управление    достигается при максимуме функции    	 
Сформулируем теперь принцип максимума: Пусть    – такое допустимое управление, что соответствующая ему траектория   , исходящая в момент    из точки   , проходит в момент     через точку   Для оптимальности управления    и траектории   необходимо существование такой ненулевой непрерывной вектор-функции    что
1– для любого момента   , являющегося точкой непрерывности управления   , если канонические уравнения удовлетворены, функция    переменной    достигает в точке    максимума;
2– в конечный момент   выполнены соотношения
	 

Динамическое программирование.	

Динамическое программирование (ДП) втеории вычислительных систем— способ решения сложных задач путём разбиения их на более простые подзадачи. Он применим к задачам соптимальной подструктурой, выглядящим как набор перекрывающихся подзадач, сложность которых чуть меньше исходной. В этом случае время вычислений, по сравнению с «наивными» методами, можно значительно сократить.
Ключевая идея в динамическом программировании достаточно проста. Как правило, чтобы решить поставленную задачу, требуется решить отдельные части задачи (подзадачи), после чего объединить решения подзадач в одно общее решение. Часто многие из этих подзадач одинаковы. Подход динамического программирования состоит в том, чтобы решить каждую подзадачу только один раз, сократив тем самым количество вычислений. Это особенно полезно в случаях, когда число повторяющихся подзадач экспоненциально велико. 
Динамическое программирование представляет собой математический аппарат, который подходит к решению некоторого класса задач путем их разложения на части, небольшие и менее сложные задачи. При этом отличительной особенностью является решение задач по этапам, через фиксированные интервалы, промежутки времени, что и определило появление термина динамическое программирование. Следует заметить, что методы динамического программирования успешно применяются и при решении задач, в которых фактор времени не учитывается. В целом математический аппарат можно представить как пошаговое или поэтапное программирование. Решение задач методами динамического программирования проводится на основе сформулированного Р. Э. Беллманом принципа оптимальности: оптимальное поведение обладает тем свойством, что каким бы ни было первоначальное состояние системы и первоначальное решение, последующее решение должно определять оптимальное поведение относительно состояния, полученного в результате первоначального решения.Из этого следует, что планирование каждого шага должно проводиться с учетом общей выгоды, получаемой по завершении всего процесса, что и позволяет оптимизировать конечный результат по выбранному критерию.[1]
Таким образом, динамическое программирование в широком смысле представляет собой оптимальное управление процессом, посредством изменения управляемых параметров на каждом шаге, и, следовательно, воздействуя на ход процесса, изменяя на каждом шаге состояние системы.В целом динамическое программирование представляет собой стройную теорию для восприятия и достаточно простую для применения в коммерческой деятельности при решении как линейных, так и нелинейных задач.
Динамическое программирование  является одним из разделов оптимального программирования. Для него характерны специфические методы и приемы, применительные к операциям, в которых процесс принятия решения разбит на этапы (шаги). Методами динамического программирования решаются вариантные оптимизационные задачи с заданными критериями оптимальности, с определенными связями между переменными и целевой функцией, выраженными системой уравнений или неравенств. При этом, как и в задачах, решаемых методами линейного программирования, ограничения могут быть даны в виде равенств или неравенств. Однако если в задачах линейного программирования зависимости между критериальной функцией и переменными обязательно линейны, то в задачах динамического программирования эти зависимости могут иметь еще и нелинейный характер. Динамическое программирование  можно использовать как для решения задач, связанных с динамикой процесса или системы, так и для статических задач, связанных, например, с распределением ресурсов. Это значительно расширяет область применения динамического программирования для решения задач управления. А возможность упрощения процесса решения, которая достигается за счет ограничения области и количества, исследуемых при переходе к очередному этапу вариантов, увеличивает достоинства этого комплекса методов.
Вместе с тем динамическому программированию свойственны и недостатки. Прежде всего, в нем нет единого универсального метода решения. Практически каждая задача, решаемая этим методом, характеризуется своими особенностями и требует проведения поиска наиболее приемлемой совокупности методов для ее решения. Кроме того, большие объемы и трудоемкость решения многошаговых задач, имеющих множество состояний, приводят к необходимости отбора задач малой размерности либо использования сжатой информации. Последнее достигается с помощью методов анализа вариантов и переработки списка состояний.
Для процессов с непрерывным временем динамическое программирование рассматривается как предельный вариант дискретной схемы решения. Получаемые при этом результаты практически совпадают с теми, которые получаются методами максимума Л. С. Понтрягина или Гамильтона-Якоби-Беллмана.
Динамическое программирование  применяется для решения задач, в которых поиск оптимума возможен при поэтапном подходе, например, распределение дефицитных капитальных вложений между новыми направлениями их использования; разработка правил управления спросом или запасами, устанавливающими момент пополнения запаса и размер пополняющего заказа; разработка принципов календарного планирования производства и выравнивания занятости в условиях колеблющегося спроса на продукцию; составление календарных планов текущего и капитального ремонтов оборудования и его замены; поиск кратчайших расстояний на транспортной сети; формирование последовательности развития коммерческой операции и т. д.[2]
2.Суть метода динамического программирования.
В основу метода динамического программирования положен принцип оптимальности, сформулированный в 1957 г. американским математиком Ричардом Беллманом: «Оптимальное поведение обладает тем свойством, что каковы бы ни были первоначальные состояние и решение в начальный момент времени, последующие решения должны составлять оптимальное поведение относительно состояния, получающегося в результате первого решения».
Физическая сущность принципа оптимальности заключается в том, что ошибка выбора решения в данный момент не может быть исправлена в будущем.
Рассматривается следующая общая задача. Имеется некоторая физическая система, в которой происходит какой-то процесс, состоящий из nшагов. Эффективность процесса характеризуется некоторым показателемW, который называютвыигрышем. Пусть общий выигрышWза всеnшагов процесса складывается из выигрышей на отдельных шагах
 (2.1)
где wi— выигрыш наi-м шаге. ЕслиWобладает таким свойством, то его называютаддитивным критерием.
Процесс, о котором идет речь, представляет собой управляемый процесс, т.е. имеется возможность выбирать какие-то параметры, влияющие на его ход и исход, причем на каждом шаге выбирается какое-то решение, от которого зависит выигрыш на данном шаге. Это решение называется шаговым управлением. Совокупность всех шаговых управлений представляет собой управление процессом в целом. Обозначим его буквойU, а шаговые управления — буквами . Тогда
 
Шаговые управления  в общем случае не числа, а, как правило, векторы, функции и т.п.
В модели динамического программирования процесс на каждом шаге находится в одном из состояний sмножества состоянийS. Считается, что всякому состоянию сопоставлены некоторые шаговые управления. Эти управления таковы, что управление, выбранное в данном состоянии при любой предыстории процесса, определяет полностью следующее состояние процесса. Обычно выделены два особых состояния:s0— начальное иsw— конечное.
Итак, пусть каждому состоянию  поставлено множество допустимых шаговых управлений , и каждому шаговому управлению , соответствует — состояние, в которое процесс попадает изsiв результате использования шагового управленияu. Пусть процесс находится в начальном состоянииs0. Выбор переводит процесс в состояниеs1= σ(s0,u1), выбор — в состояниеs2= σ(s1,u2) и т.д. В результате получается траектория процесса, которая состоит из последовательности пар
 
и заканчивается конечным состоянием. Для единообразия можно считать, что  включает только одно состояние , оставляющее процесс в том же конечном состоянии. Следует отметить, что множества допустимых состояний и управлений
 (2.2)
 (2.3)
конечны и Usдля различныхsне пересекаются.
В общем виде задача динамического программирования формулируется следующим образом: найти такую траекторию процесса, при которой выигрыш (2.1)будет максимальным.
То управление, при котором достигается максимальный выигрыш, называется оптимальным управлением. Оно состоит из совокупности шаговых управлений
 (2.4)
Тот максимальный выигрыш, который достигается при этом управлении обозначим Wmax:
Wmax= maxU{W(u)}.             (2.5)
Рассмотрим на примере задачи о рюкзаке, что понимается под шагом, состоянием, управлением и выигрышем.
Загрузку рюкзака можно представить себе как процесс, состоящий из nшагов. На каждом шаге требуется ответить на вопрос: взять данный предмет в рюкзак, или нет? Таким образом, шаг процесса — присваивание переменнойxiзначения 1 или 0.
Теперь определим состояния. Очевидно, что текущее состояние процесса характеризует остаточная грузоподъёмность рюкзака — вес, который остался в нашем распоряжении до конца (до полной укладки рюкзака). Следовательно, под состоянием перед i-м шагом понимается величина
 (2.6)
при этом s0является начальным состоянием, которому соответствует величинаb— исходная грузоподъемность рюкзака.
Управление на i-м шаге означает присваивание двоичной переменнойxiзначения 0 или 1. Значит, на каждом шаге имеем всего два управления. Причем допустимость управленияui, устанавливающегоxi= 1, определяется условием
 (2.7)
Далее везде вместо переменных  будем использовать соответствующие управления . Тогда формулы (2.6), (2.7) примут следующий вид:
 (2.8)
 (2.9)
Шаговый выигрыш можно определить как  . Поэтому
 (2.10)
Требуется найти оптимальное управление  , при котором величина выигрыша (2.10) обращается в максимум.[3]
3. Пример решения задачи методом динамического программирования.
Задание. Инвестор выделяет средства в размере 5 тыс. ден. ед., которые должны быть распределены между тремя предприятиями.
Требуется, используя принцип оптимальности Беллмана, построить план распределения инвестиций между предприятиями, обеспечивающий наибольшую общую прибыль, если каждое предприятие при инвестировании в него средств xтыс. ден. ед. приносит прибыльp;(x) тыс. ден. ед. (i=1, 2 и 3) по следующим данным:
Инвестирование средств (тыс. ден. ед.)	Прибыль (тыс. ден. ед.)
x	pi(x)	p2 (x)	p3(x)
1	3,22	3,33	4,27
2	3,57	4,87	7,64
3	4,12	5,26	10,25
4	4	7,34	15,93
5	4,85	9,49	16,12
Решение. Составим математическую модель задачи.
1.	Число шагов равно 3.
2.	Пусть s- количество средств, имеющихся в наличии перед данным шагом, и характеризующих состояние системы на каждом шаге.
3.	Управление на i-ом шаге (i=1,2,3) выберемxi- количество средств, инвестируемых вi- ое предприятие.
4.	Выигрыш pi(xi) наi-ом шаге - это прибыль, которую приноситi-ое предприятие при инвестировании в него средствxi. Если через выигрыш в целом обозначить общую прибыльW, тоW=p1(x1)+p2(x2)+p3(x3).
5.	Если в наличии имеются средства в количестве s тыс. ден. ед. и в i-ое предприятие инвестируется x тыс. ден. ед, то для дальнейшего инвестирования остается (s-x) тыс. ден. ед. Таким образом, если на i-ом шаге система находилась в состоянии s и выбрано управление x, то на (i+1)-ом шаге система будет находится в состоянии (s-x), и, следовательно, функция перехода в новое состояние имеет вид: fi(s, x) = s-x.
6.	На последнем (i=3) шаге оптимальное управление соответствует количеству средств, имеющихся в наличии, а выигрыш равен доходу, приносимым последним предприятием:x3(s)=s,W3(s)=p3(s).
7.	Согласно принципу оптимальности Беллмана, управление на каждом шаге нужно выбирать так, чтобы оптимальной была сумма выигрышей на всех оставшихся до конца процесса шагах, включая выигрыш на данном шаге. Основное функциональное уравнение примет вид
W2(s) = max{p2(x)+ W3(s -x)}
x< s
Проведем пошаговую оптимизацию, по результатам которой заполним таблицу.
s	i=3	i=2	i=1
	x3(s)	W3(s)	x2(s)	W2(s)	xi(s)	Wi(s)
1	1	4,27	0	4,27		
2	2	7,64	0	7,64		
3	3	10,25	1	10,97		
4	4	15,93	0	15,93		
5	5	16,12	1	19,26	0	19,26
В первой колонке таблицы записываются возможные состояния системы, в верхней строке - номера шагов с оптимальным управлением и выигрышем на каждом шаге, начиная с последнего. Так как для последнего шага i=3 функциональное уравнение имеет вид x3(s)=s, W3(s)=p3(s), то две колонки таблицы, соответствующие i=3, заполняются автоматически по таблице исходных данных.
На шаге i=2 основное функциональное уравнение имеет вид
W2 (s) = max{p2 (x) + W3(s - x)}
x≤ s
Поэтому для проведения оптимизации на этом шаге заполним таблицу для различных состояний sпри шагеi=3.
s	x	s-x	p2(x)	W3(s-x)	p2(x)+W3(s-x)	W2(s)
1	0	1	0	4,27	4,27	4,27
	1	0	3,33	0	3,33	
2	0	2	0	7,64	7,64	7,64
	1	1	3,33	4,27	7,6	
	2	0	4,87	0	4,87	
3	0	3	0	10,25	10,25	10,97
	1	2	3,33	7,64	10,97	
	2	1	4,87	4,27	9,14	
	3	0	5,26	0	5,26	
4	0	4	0	15,93	15,93	15,93
	1	3	3,33	10,25	13,58	
	2	2	4,87	7,64	12,51	
	3	1	5,26	4,27	9,53	
	4	0	7,34	0	7,34	
5	0	5	0	16,12	16,12	19,26
	1	4	3,33	15,93	19,26	
	2	3	4,87	10,25	15,12	
	3	2	5,26	7,64	12,9	
	4	1	7,34	4,27	11,61	
	5	0	9,49	0	9,49	
На шаге i=1 основное функциональное уравнение имеет вид
Wx( s) = max{ px( x) + W2( s - x)}
x ≤ s
а состояние системы перед первым шагом s=5, поэтому для проведения оптимизации на этом шаге заполним таблицу.
s	x	s-x	pi(x)	W2(s-x)	pi(x)+W2(s-x)	Wi(s)
5	0	5	0	19,26	19,26	19,26
	1	4	3,22	15,93	19,15	
	2	3	3,57	10,97	14,54	
	3	2	4,12	7,64	11,76	
	4	1	4	4,27	8,27	
	5	0	4,85	0	4,85	
Видно, что наибольшее значение выигрыша составляет 19,26. При этом оптимальное управление на первом шаге составляет x 1(s1)=0 (s1=5), на втором шагеx2(s2) =1 (s2=s1-x1=5) и на третьем шагеx3(s3) =4 (s3=s2-x2=4).
Это означает, что (0, 1, 4) - оптимальный план распределения инвестиций между предприятиями.
Таким образом, для получения наибольшей общей прибыли в размере 19,26 тыс. ден. ед., необходимо вложить 1 тыс. ден. ед. во второе предприятие и 4 тыс. ден. ед. в третье предприятие.[4]

 
