## Организация сценариев отображения и просмотра HTML документов с использованием объектноориентированных языков программирования.

Интерактивные Web-документы

Стандартный язык разметки HTML позволяет легко и быстро создавать Web-страницы, передаваемые по сети Интернет. Это достаточно удобный инструмент работы в сети, однако загружаемые в окно браузера страницы являются статичными. Пользователь не может изменять их содержимое, не может взаимодействоватьс ними. Мы живем в динамичном, меняющемся мире, и, естественно, хотели бы видеть то же самое и в рукотворном мире - мире Интернета.

Для придания динамичности HTML-страницам был предложен и реализован ряд технологий, "оживляющих" и создающих "реагирующие" на действия пользователя HTML-документы. Одной из первых технологий в этом ряду стоит технология, основанная на GGI-сценарии - программе, инициализируемой на сервере при передаче на него информации из полей форм HTML. Ее недостатком является реализация простейшего сценария вида: "Я вам поcлал сообщение, а вы мне на него не ответили". Более того, подробный сценарий существенно влияет на нагрузку сети: любой запрос и ответ занимает ресурсы сети.

Языки сценариев действительно делают HTML-страницы интерактивными. Содержание страницы может зависеть от желания пользователя, однако для его изменения все равно необходимо производить загрузку новой страницы либо во фрейм отображаемой страницы, либо в новое окно браузера. Причем эти изменения связаны с необходимостью взаимодействия с элементами управления: кнопка, поле ввода, переключатель и т. п. Хотелось бы, чтобы страницы действительно стали динамичными, как наш меняющийся мир: за поворотом мы видим открывающийся новый вид, не взаимодействуя ни с какими "элементами управления". Двигаясь по странице и перемещая по ней курсор мыши, хочется увидеть новую информацию, скрытую до тех пор, пока курсор не пройдет, например, над определенным словом или изображением, расположенным на странице. Поместив курсор мыши на некоторый элемент списка, хотелось бы увидеть уточняющую информацию, скрытую для пользователя до этого момента. Или, указав просто на слово "дальше", увидеть на странице очередную картину любимого художника. Все это реализуется с помощью так называемого динамического языка разметки страниц (Dynamic HTML), который, по существу, состоит из трех компонентов каскадной таблицы стилей (CSS), JavaScript и HTML, соединенных объектной моделью документа (DOM).

Выполняемые сценарии

До появления операционных систем с графическим интефейсом (типа Windows) было распространено так называемое "процедурное" программирование, суть которого заключается в том, что программа жестко определяет, когда и в какой последовательности вызываются те или иные процедуры, в совокупности составляющие программу. Программист должен был заранее разработать и реализовать алгоритм выполнения своей программы. При ее запуске она жестко следовала инструкциям вызова соответствующих процедур.

По-иному выглядит работа приложения с графическим интерфейсом. Оно должно реагировать на действия пользователя: нажал ли он кнопку, а если нажал - то какую, хочет ли он выполнить команду какого-либо меню и т. п. В этом случае выполняемая программа на должна следовать один раз и навсегда по заданному алгоритму выполнения. Она должна иметь возможность запускать на выполнение процедуры, реализующие действие, которое желает выполнить в данный момент пользователь приложения.

Такая технология реализуется с помощью концепции события, которое представляет собой действие пользователя (например, нажатие кнопки) или сообщение, генерируемое операционной системой (открылось закрытое окном другого приложения окно нашего приложения). В объектно ориентированных технологиях любое событие представляется объектом, обратившись к свойствам которого можно получить некоторые параметры сгенерированного события.

События и сообщения тесно связаны: любое событие является причиной посылки некоторого сообщения операционной системе. И в тоже время некоторые сообщения операционной системы, адресованные приложению, представляются в нем в виде некоторых объектов. Таким образом, можно организовать перехват событий в приложении и написать собственную процедуру обработки события, выполняющую все необходимые действия, которые, например, должны быть ассоциированы с нажатием некоторой кнопки графического интерфейса приложения.

Объектные модели языков сценариев тесно связаны с тэгами HTML. При загрузке страницы HTML в браузер интерпретатор языка создает объекты со свойствами, определяемыми значениями параметров тэгов страницы. Говорят, что браузер отображает HTML-страницу в свойствах объектов, и иногда этот процесс называют отражением (reflection). Созданные объекты существуют в виде иерархической структуры, отражающей структуру самой HTML-страницы. На верхнем уровне расположен объект window, представляющий собой активное окно браузера. Далее вниз по иерархической лестнице следуют объекты, представляющие соответственно фрейм, непосредственно сам документ, адрес загружаемого документа, список ранее загружавшихся документов и т. д. Значения свойств объектов отражают значения соответствующих параметров тэгов страницы или установленных системных параметров.

Для правильного использования объектных моделей следует четко понимать, как браузер компонует страницы и, тем самым, создает иерархию объектов. При загрузке страницы просматриваются сверху вниз, тем самым последовательно происходит компановка страницы и ее отображение в окне браузера. А это означает, что и объектная модель страницы также формируется последовательно, по мере ее обработки. Поэтому невозможно обратиться из сценария, расположенного ранее какой-либо формы на странице, к элементам этой формы. Всегда следует помнить о том, что браузер последовательно сверху вниз интерпретирует содержимое HTML-страницы.

Еще один аспект работы с объектами языков сценариев заключается в том, что нельзя изменить свойства объектов. Браузер обрабатывает страницу только один раз, компонуя и отображая ее. Поэтому попытка в сценарии изменить свойство отображенного элемента страницы обречена на провал. Только повторная загрузка страницы приведет к желаемому результату.

Язык создания сценариев JavaScript.

В настоящее время трудно найти в Интернете HTML-страницу, не содержащую ни одного оператора языка JavaScript. Любой Web-мастер или создатель собственной страницы в Интернете заботится о том, чтобы как можно большее число потенциальных посетителей разработанного сайта или личной страницы увидели в окне своего браузера именно то, что задумывалось разработчиком страницы. Дело в том, что наиболее популярные на настоящий момент браузеры могут поддерживать не все существующие технологии, реализованные в HTML, или использовать их несколько отлично друг от друга. Поэтому практически любая страница содержит определение и вызов функции языка JavaScript для идентификации используемого пользователем браузера, а также его версии.

Язык программирования JavaScript разработан фирмой Netscape для создания интерактивных HTML-документов. Это объектно-ориентированный язык для разработки встраиваемых приложений, выполняющихся как на стороне клиента, так и на стороне сервера. Синтаксис языка очень похож на синтаксис языка Java - поэтому его часто называют Java-подобным. Клиентские приложения выполняются браузером просмотра Web-документов на машине пользователя, серверные приложения выполняются на сервере.

При разработке обоих типов приложений используется общий компонент языка, называемый ядром и включающий определения стандартных объектов и конструкций (переменные, функции, основные объекты и средство LiveConnect взаимодействия с Java-апплетами), и соответствующие компоненты дополнений языка, содержащие специфические для каждого типа приложений определения объектов.

Клиентские приложения непосредственно встраиваются в HTML-страницы и интерпретируются браузером по мере отображения частей документов в его окне. Серверные приложения для увеличения призводительности предварительно компилируются в промежуточный байт-код.

Перечислим основные области использования JavaScript при создании интерактивных HTML-страниц:

динамическое создание документа с помощью сценария;
оперативная проверка достоверности заполняемых пользователем полей форм HTML до передачи их на сервер;
создание динамических HTML-страниц совместно с каскадными таблицами стилей и объектной моделью документа;
взаимодействие с пользователем при решении "локальных" задач, решаемых приложением JavaScript, встроенным в HTML-страницу.

Здесь можно увидеть пример использования JavaScript

Язык VBScript

Язык создания сценариев VBScript разработан фирмой Vicrosoft и является подмножеством достаточно распространенного в среде программистов языка Visual Basic разработки прикладных Windows-приложений. Как и родитель, язык VBScript достаточно прост и легок в изучении.

Преимуществом его применения для создания сценариев является возможность использования, с небольшими корректировками, ранее написанных процедур на языках Visual Basic и Visual Basic for Application.

Функциональные возможности сценариев, написанных на VBScript, ничем не отличаются от возможностей сценариев JavaScript: динамическое создание документа или его частей, перхват и обработка событий и т. д.

VBScript используется для написания сценариев клиента (в этом случае браузер должен иметь встроенный интерпретатор этого языка), а также для написания сценариев на сервере (в этом случае сервер должен поддерживать язык VBScript). Для создания сценариев клиента используется набор объектов, аналогичный набору объектов JavaScript. Объекты клиента и сервера отличаются друг от друга, но существует общая часть (ядро) объектов, используемых при разработке как сценариев клиента, так и сценариев сервера.

Здесь можно увидеть пример использования VBScript
Вверх

CGI-сценарии и язык Perl

Основу "Всемирной паутины" WWW составляют Web-узлы - компьютеры, на которых выполняется специальная программа - Web-сервер, ожидающая запроса со стороны клиента на выдачу документа. Документы сохраняются на Web-узле, как правило, в формате HTML. Клиентом Web-сервера является программа-браузер, выполняющаяся на удаленном компьютере, которая осуществляет запрос к Web-серверу, принимает запрошенный документ и отображает его на экране.

Аббревиатура CGI (Common Gateway Interface) обозначает часть Web-сервера, которая может взаимодействовать с другими программами, выполняющимися на этом же Web-узле, и в этом смысле является шлюзом (gateway-шлюз) для передачи данных, полученных от клиента, программам обработки, таким как электронные таблицы и др. CGI включает общую среду (набор переменных) и протоколы для взаимодействия с этими программами.

Общая схема работы CGI состоит из следующих элементов.

Получение Web-сервером информации от клиента-браузера. Для передачи данных Web-серверу в языке HTML имеется средство, называемое форма. Форма в HTML-документе состоит из набора полей ввода, отображаемых браузером в виде графических элементов управления: селекторных кнопок, опций, строк ввода текста, управляющих кнопок и т. д.
Анализ и обработка полученной информации. Данные, извлеченные из HTML-формы, передаются для обработки CGI-программе. Они не всегда могут быть обработаны CGI-программой самостоятельно. Например, они могут содержать запрос к некоторой базе данных, которую CGI- программа читать "не умеет". В этом случае CGI-программа на основании полученной информации формирует запрос к компетентной программе, выполняющейся на том же компьютере. CGI-программа может быть написана на любом языке программирования, имеющем средства обмена данными между программами. В среде UNIX для этой цели наиболее часто используется язык Perl, а так как UNIX является наи- более популярной операционной системой для Web-серверов, то можно считать Perl наиболее популярным языком CGI-программирования. Программа на языке Perl представляет собой последовательность операторов, которые интерпретатор языка выполняет при каждом запуске без преобразования исходного текста программы в выполняемый двоичный код. По этой причине CGI-программы называют также CGI- сценариями или CGi-скриптами.
Создание нового HTML-документа и пересылка его браузеру. После обработки полученной информации CGI-программа создает динамический или, как говорят, виртуальный HTML-документ, или формирует ссылку на уже существующий документ и передает результат браузеру.
 
