## Метод динамического программирования для многошаговых задач принятия решений. Принцип оптимальности Беллмана. Основное функциональное уравнение. Вычислительная схема метода динамического программирования.

Динамическое программирование представляет собой метод оптимизации многошаговых процессов принятия решении, позволяющий указать пути исследования целого класса экстремальных задач.

Требование к задаче:
1.	Задача должна допускать интерпретацию как n-шаговый процесс принятия решений.
2.	Задача должна быть определена для любого числа шагов и иметь структуру, не зависящую от их числа.
3.	При рассмотрении k-шаговой задачи должно быть задано некоторое множество параметров, описывающих состояние системы, от которых зависят оптимальные значения переменных. Причем это множество не должно изменяться при увеличении числа шагов.
4.	Выбор решения (управления) на k-м шаге не должен оказывать влияния на предыдущие решения, кроме необходимого пересчета переменных.
Задача о выборе траектории, задача последовательного принятия решения, задача об использовании рабочей силы, задача управления запасами — классические задачи динамического программирования.

Рассмотрим некоторую динамическую систему S. Пусть на k-м шаге (k = 1, 2,..., n) состояние системы определяется совокупностью чисел  , которые получены в результате реализации управления _Uk, обеспечивающего переход системы S из состояния X k-1 в состояние Xk . Будем полагать, что Xk зависит от X k-1 и Uk, и не зависит от того, как система пришла в состояние X k-1 (свойство отсутствия последействия). 
Пусть  ) есть доход (выигрыш), полученный в результате реализации k-го шага. Тогда общий выигрыш полагаем равным   (свойство аддитивности целевой функции). Совокупность управлений U* = (u * 1 , u * 2 ,..., u *n ), в результате реализации которых система S переходит за n шагов из начального состояния X0 в конечное Xn и при этом функция F принимает наибольшее значение, назовем оптимальной стратегией управления. 
Принцип оптимальности Белмана. Каково бы ни было состояние системы перед очередным шагом, надо выбрать управление на этом шаге так, чтобы выигрыш на данном шаге плюс оптимальный выигрыш на всех последующих шагах был бы максимальным. 
Оптимальную стратегию можно получить, если сначала найти оптимальную стратегию управления на последнем n-м шаге, затем на двух последних шагах и т.д. вплоть до первого шага. Таким образом, решение задачи динамического программирования целесообразно начинать с определения оптимального решения на последнем n-м шаге. Для того, чтобы найти это решение, нужно сделать всевозможные предположения о том, как мог закончиться предпоследний шаг и с учетом этого выбрать управление  , обеспечивающее максимальное значение функции  . Такое управление , выбранное при определенных предположениях о том, как окончился предыдущий этап, называется условно оптимальным. 
Принцип оптимальности Беллмана требует находить на каждом шаге условно оптимальные управления для любого из возможных исходов предыдущего шага. 
Условная оптимизация. Обозначим через   максимальный доход, получаемый за n шагов при переходе системы S из начального состояния X0 в конечное состояние Xn, а через Fn-k (Xk ) - то же при переходе из Xk в Xn и оптимальном управлении на последних n-k шагах. Тогда
  
Последнее соотношение называется основным функциональным уравнением Беллмана и представляет собой математическую формулировку принципа оптимальности. 
Положим k = n - 1, тогда (*) 
где F0(Xn) считаем известным. Используя (*) и рассматривая всевозможные допустимые состояния X  ,..., системы на (n-1)-м шаге находим условно-оптимальные управления   ,... и соответствующие значения функции   ),.... 
Таким образом, на n-м шаге находим условно-оптимальное управление при любом допустимом состоянии системы после (n- 1)-го шага. То есть, в каком бы состоянии система не оказалась после (n+1)-го шага, нам уже известно, какое следует принять решение на n-м шаге. Известно и соответствующее значение функции. (*) 
Последовательно осуществляя этот итерационный процесс, дойдем, наконец, до первого шага. На этом шаге нам известно, в каком состоянии может находиться система. 
в результате последовательного прохождения всех этапов от конца к началу определяем максимальное значение выигрыша за n шагов и для каждого из них находим условно оптимальное управление. 
Безусловная оптимизация. Чтобы найти оптимальную стратегию управления, то есть определить искомое решение задачи, нужно теперь пройти всю последовательность шагов, только на этот раз от начала к концу, а именно: на первом шаге в качестве оптимального управления  возьмем найденное условно оптимальное управление   . На втором шаге найдем состояние X1* , в которое переводит систему управление  . Это состояние определяет условно оптимальное управление  , которое теперь будем считать оптимальным ( ),  и т.д. В результате находим решение задачи - максимально возможный доход и оптимальную стратегию управления U*, включающую оптимальные управления на отдельных шагах (  ,...,  ). 
рассмотрен нахождение решения задачи динамического программирования в общем виде. Этот процесс является довольно громоздким, поэтому он используется обычно с применением ЭВМ. Существуют реализации идей динамического программирования для задач распределения ограниченных ресурсов, оптимизации путей на сетях, упаковки ранца и др., которые могут быть использованы, если математическая постановка решаемой задачи будет сведена к одной указанных формулировок.

### Принцип оптимальности Беллмана
Принцип оптимальности впервые был сформулирован Ричардом Эрнестом Беллманом в 1953 г. (в трактовке Е.С. Вентцель):

Каково бы ни было состояние системы в результате какого-либо числа шагов, на ближайшем шаге нужно выбирать управление таким образом, чтобы оно в совокупности с оптимальным управлением на всех последующих шагах приводило к оптимальному выигрышу на всех оставшихся шагах, включая данный.

Рассмотрим общую задачу динамического программирования, приведенную выше. На каждом шаге кроме последнего для любого состояния системы sk-1 управленческое решение Xk необходимо выбирать «с оглядкой», так как этот выбор влияет на последующее состояние системы sk.

На последнем шаге исходя из состояния системы sn-1 управленческое решение Xn можно планировать локально-оптимально, т.е. исходя только из соображений этого шага.

### Вычислительная схема метода динамического программирования

– Разделить процедуру решения задачи на этапы. Иногда это разбиение
обеспечивается постановкой задачи, иногда требуется вводить его искусственно. Обычно, чем больше количество шагов, тем проще реализация каждого отдельного шага, однако, с другой стороны, слишком мелкое разбиение может
приводить к лишним расчетам, усложняющим процедуру поиска оптимального
решения.
– Выбрать параметры, характеризующее состояние управляемой системы
перед каждым шагом. Набор этих параметров не должен зависеть от этапа и их
количество должно быть по возможности небольшим. Если состояние системы
описывается многими параметрами (так называемыми фазовыми координатами), то становится трудно перед каждым шагом перебрать все их варианты и
для каждого найти оптимальное условное управление. Последнее ещё больше
затрудняется если и число возможных вариантов управления велико. В этих
случаях применение метода динамического программирования может стать нерациональным, эту проблему Р. Беллман назвал «проклятием многомерности».
– Определить допустимые управления для каждого состояния на каждом
этапе.
– Определить функции состояния (1.4), связывающие этапы между собой,
и функции стоимости управлений.
– Записать основное рекуррентное уравнение динамического программирования (1.5) или (1.6).
– Найти, пользуясь составленным уравнением, значения соответствующей функции Беллмана на каждом шаге и условные оптимальные управления.
При решении конкретной задачи оптимизации часто оказывается возможным
сократить объём вычислений за счёт состояний, заведомо не принадлежащих
оптимальной траектории.
– Восстановить оптимальную траекторию и оптимальное управление